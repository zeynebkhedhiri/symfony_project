<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Gestion des Réservations et Événements{% endblock %}</title>
    <link rel="stylesheet" href="/css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<header>
    <nav>
        <a href="{{ path('app_home') }}">Accueil</a>
        <a href="{{ path('app_event_index') }}">Événements</a>

        <div id="nav-links">
            <!-- Navigation links will be updated dynamically -->
        </div>
    </nav>
</header>
<main>
    {% block body %} {% endblock %}
</main>
<footer>
    <p>&copy; 2024 - Gestion des Réservations et Événements</p>
</footer>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const token = localStorage.getItem('token');
        const navLinks = document.getElementById('nav-links');

        if (token) {
            // User is logged in
            navLinks.innerHTML = `
                <a href="{{ path('app_logout') }}" id="logout-link">Logout</a>
            `;
        } else {
            // User is not logged in
            navLinks.innerHTML = `
                <a href="/login/index">Login</a>
                <a href="{{ path('app_user_new') }}">Sign Up</a>
                <a href="{{ path('app_reservation_index') }}">Réservations</a>

            `;
        }
    });
</script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const logoutLink = document.getElementById('logout-link');

        if (logoutLink) {
            logoutLink.addEventListener('click', function(event) {
                // Prevent the default link behavior to let us clear localStorage
                event.preventDefault();

                // Clear the token from localStorage
                localStorage.removeItem('token');

                // Redirect to the home page (or login page)
                window.location.href = '{{ path('app_home') }}'; // Change to any route you prefer
            });
        }
    });
</script>
</body>
</html>
